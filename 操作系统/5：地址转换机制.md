# 地址转换机制

## 前言

在内存虚拟化的时候我们提到[[3：受限直接执行]]这可以尽可能地提高效率，因此在虚拟化地址的时候，我们依旧使用类似的策略。

## 基址加界限的动态地址转换

动态地址转换也被叫做“基于硬件的地址转换”，因为整个**地址转换的过程只有硬件在参与**。想要完成动态地址转换需要有**基址寄存器**和**界限寄存器**，其中基址寄存器记录好操作系统将要启用的物理地址的开头的地址称为base，而CPU在执行程序的时候只能用虚拟地址称为virtual。而讲虚拟地址映射到真实地址的公式如下：

$$
physical = virtual + base
$$

对于界限寄存器，其功能则是检查地址是否超出边界。基于类似这两种相互配合来进行地址转换的硬件叫做**MMU**，即内存管理单元。

## 分段

在基址加界限的地址转换中有一个缺陷：内存管理单元的地址中总是有一大片的连续，很容易造成地址的浪费。为了提高利用率，使用**分段**。

