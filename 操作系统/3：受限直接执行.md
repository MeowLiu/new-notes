## 受限直接执行的内涵
为了尽可能地提高程序执行的效率，我们会尽可能的让程序直接访问硬件，只有在关键点才会让操作系统介入，以确保程序的执行是正确的。
## 分时共享机制的基本思想
为了让多个程序共享物理内存，操作系统进行了内存的地址的虚拟化，而为了多个程序共享CPU，操作系统同样也进行了CPU的虚拟化，其基本思想是：**先让一个进程执行一段时间，再切换到另一个进程上运行**。
那么CPU到底是如何进行进程的切换的？以及操作系统如何约束进程以防止其执行恶意的行为？
## 进程切换
在进程进行[**系统调用**](系统调用)或者发生**[时钟中断](时钟中断)**之后，会从用用户态转换为内核态，在转换成内核态之后，操作系统会进行考虑是否切换进程，如果需要切换进程，则首先将旧进程的**[进程状态](进程状态)**从寄存器中保存到**[进程控制块](进程控制块)**中，然后再从进程控制块中把新的进程的进程状态复制到寄存器，最后从内核态回到用户态之后，进程就已经完成切换了。
## 受限执行
为了保证进程不会在内核态中执行恶意的行为，操作系统并不会让进程完全陷入内核态，而是提供一些系统调用（大约几百个系统调用）供给给进程，只允许进程执行系统调用能做的事情。系统调用和函数调用差不多，可以看成是系统级别的API接口。
